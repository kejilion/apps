# --- 基础信息 ---
local app_id="hubproxy"
local app_name="HubProxy"
local app_text="Docker和GitHub加速服务器"
local app_url="https://github.com/sky22333/hubproxy"
local docker_name="hubproxy"
local docker_port="8202"
local app_size="1"

# --- 核心逻辑 ---

# 1. 安装函数
docker_app_install() {
    # 必须在 /home/docker/ 下创建应用目录
    mkdir -p /home/docker/${app_id} && cd /home/docker/${app_id}
    
    # 生成 docker-compose.yml 文件
    cat <<EOF > docker-compose.yml
services:
  ${app_id}:
    image: ghcr.io/sky22333/hubproxy
    container_name: ${docker_name}
    ports:
      - "${docker_port}:5000"
    restart: always
EOF
    
    # 启动容器
    docker compose up -d
    
    echo "${app_name} 安装完成，访问端口为: ${docker_port}"
}

# 2. 更新函数
docker_app_update() {
    cd /home/docker/${app_id}
    docker compose pull
    docker compose up -d
    echo "${app_name} 更新完成"
}

# 3. 卸载函数
docker_app_uninstall() {
    cd /home/docker/${app_id}
    docker compose down --rmi all
    cd ..
    rm -rf /home/docker/${app_id}
    echo "${app_name} 卸载完成"
}

# --- 结尾必须包含此行以完成注册 ---
docker_app_plus
